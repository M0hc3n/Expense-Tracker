{"ast":null,"code":"import _toConsumableArray from\"C:/Users/TRETEC/Desktop/Software Engineering/Tp/code/Expense Tracker Website/light-bootstrap-dashboard-react/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/TRETEC/Desktop/Software Engineering/Tp/code/Expense Tracker Website/light-bootstrap-dashboard-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState,useEffect}from\"react\";import ChartistGraph from\"react-chartist\";// react-bootstrap components\nimport{Card,Table,Container,Row,Col}from\"react-bootstrap\";import{AuthContext}from\"context/AuthContext\";import{db}from\"database/firebase\";import{collection,getDocs,query,where}from\"firebase/firestore\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Dashboard(){var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser,userInfo=_useContext.userInfo;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),expenses=_useState2[0],setExpenses=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),sumOfExpenses=_useState4[0],setSumOfExpenses=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),subUsers=_useState6[0],setSubUsers=_useState6[1];var _useState7=useState([[]]),_useState8=_slicedToArray(_useState7,2),subUsersExpenses=_useState8[0],setSubUsersExpenses=_useState8[1];// available categories to be shown\nvar _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),listOfCategories=_useState10[0],setListOfCategories=_useState10[1];useEffect(function(){try{var q=query(collection(db,\"Expenses\"),where(\"user_id\",\"==\",currentUser.uid));getDocs(q).then(function(querySnapshot){setExpenses([]);querySnapshot.forEach(function(docSnapshot){setExpenses(function(oldVal){return[].concat(_toConsumableArray(oldVal),[docSnapshot.data()]);});// update the total sum of the expenses\n// setSumOfExpenses( expenses.reduce((acc, curr) => acc + curr.expenseTotalPrice ,0) );\nvar sumOfExpenses_=0;for(var i=0;i<expenses.length;i++){sumOfExpenses_+=expenses[i][\"expenseTotalPrice\"];}setSumOfExpenses(sumOfExpenses_);});});}catch(error){console.log(error);}try{var _q=query(collection(db,\"users\"),where(\"user_id\",\"==\",currentUser.uid));getDocs(_q).then(function(querySnapshot){// handles their number\nquerySnapshot.forEach(function(docSnapshot){setSubUsers(function(oldVal){return oldVal.length>0?oldVal:docSnapshot.data()[\"fullName\"]?[].concat(_toConsumableArray(oldVal),[docSnapshot.data()]):oldVal;});});querySnapshot.forEach(function(docSnapshot){if(docSnapshot.data()[\"fullName\"]){var subQ=query(collection(db,\"Expenses\"),where(\"user_id\",\"==\",docSnapshot.data()[\"uid\"]));setSubUsersExpenses([[]]);getDocs(subQ).then(function(querySub){setSubUsersExpenses(function(prev){var subUserExpense=[];querySub.forEach(function(docSub){subUserExpense.push(docSub.data()[\"expenseTotalPrice\"]);});return[].concat(_toConsumableArray(prev),[subUserExpense]);});});}});});}catch(error){console.log(error);}try{var _q2=query(collection(db,\"Expenses Categories\"),where(\"user_id\",\"==\",userInfo.is_sub_user?userInfo.sub_user_code:currentUser.uid));setListOfCategories([]);getDocs(_q2).then(function(querySnapshot){querySnapshot.forEach(function(document){setListOfCategories(function(prev){if(document.data()[\"numberOfExpenses\"]>0){return prev.concat({category:document.data()[\"expenseCategory\"],cardinality:document.data()[\"numberOfExpenses\"]});}else{return prev.concat({category:\"\",cardinality:0});}});});});}catch(error){console.log(error);}},[currentUser]);console.log(subUsersExpenses,listOfCategories);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Container,{fluid:true,children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{lg:\"3\",sm:\"6\",children:/*#__PURE__*/_jsxs(Card,{className:\"card-stats\",children:[/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{xs:\"5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"icon-big text-center icon-warning\",children:/*#__PURE__*/_jsx(\"i\",{className:\"nc-icon nc-chart text-warning\"})})}),/*#__PURE__*/_jsx(Col,{xs:\"7\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"numbers\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"card-category\",children:\"Expenses\"}),/*#__PURE__*/_jsxs(Card.Title,{as:\"h4\",children:[\"$ \",expenses.length]})]})})]})}),/*#__PURE__*/_jsxs(Card.Footer,{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-redo mr-1\"}),\"Update Now\"]})]})]})}),/*#__PURE__*/_jsx(Col,{lg:\"3\",sm:\"6\",children:/*#__PURE__*/_jsxs(Card,{className:\"card-stats\",children:[/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{xs:\"5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"icon-big text-center icon-warning\",children:/*#__PURE__*/_jsx(\"i\",{className:\"nc-icon nc-light-3 text-success\"})})}),/*#__PURE__*/_jsx(Col,{xs:\"7\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"numbers\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"card-category\",children:\"Revenue\"}),/*#__PURE__*/_jsxs(Card.Title,{as:\"h4\",children:[\"$ \",userInfo.income]})]})})]})}),/*#__PURE__*/_jsxs(Card.Footer,{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"far fa-calendar-alt mr-1\"}),\"Last day\"]})]})]})}),/*#__PURE__*/_jsx(Col,{lg:\"3\",sm:\"6\",children:/*#__PURE__*/_jsxs(Card,{className:\"card-stats\",children:[/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{xs:\"5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"icon-big text-center icon-warning\",children:/*#__PURE__*/_jsx(\"i\",{className:\"nc-icon nc-vector text-danger\"})})}),/*#__PURE__*/_jsx(Col,{xs:\"7\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"numbers\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"card-category\",children:\"Expenses\"}),/*#__PURE__*/_jsx(Card.Title,{as:\"h4\",children:expenses.length})]})})]})}),/*#__PURE__*/_jsxs(Card.Footer,{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"far fa-clock-o mr-1\"}),\"In the last hour\"]})]})]})}),/*#__PURE__*/_jsx(Col,{lg:\"3\",sm:\"6\",children:/*#__PURE__*/_jsxs(Card,{className:\"card-stats\",children:[/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{xs:\"5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"icon-big text-center icon-warning\",children:/*#__PURE__*/_jsx(\"i\",{className:\"nc-icon nc-favourite-28 text-primary\"})})}),/*#__PURE__*/_jsx(Col,{xs:\"7\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"numbers\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"card-category\",children:\"Subusers\"}),/*#__PURE__*/_jsx(Card.Title,{as:\"h4\",children:subUsers.length})]})})]})}),/*#__PURE__*/_jsxs(Card.Footer,{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-redo mr-1\"}),\"Update now\"]})]})]})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:\"8\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(Card.Header,{children:[/*#__PURE__*/_jsx(Card.Title,{as:\"h4\",children:\"Subusers Expenses\"}),/*#__PURE__*/_jsx(\"p\",{className:\"card-category\",children:\"Last 24 Hours \"})]}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsx(\"div\",{className:\"ct-chart\",id:\"chartHours\",children:/*#__PURE__*/_jsx(ChartistGraph,{data:{// labels: [\"SUN\", \"MON\", \"TUE\", \"WED\", \"THR\", \"FRI\", \"SAT\"],\n// series: [\n//   [287, 385, 490, 492, 554, 586, 698, 695],\n//   [67, 152, 143, 240, 287, 335, 435, 437],\n//   [23, 113, 67, 108, 190, 239, 307, 308],\n// ],\nseries:subUsersExpenses},type:\"Line\",options:{low:0,high:800,showArea:false,height:\"245px\",axisX:{showGrid:false},lineSmooth:true,showLine:true,showPoint:true,fullWidth:true,chartPadding:{right:50}},responsiveOptions:[[\"screen and (max-width: 640px)\",{axisX:{labelInterpolationFnc:function labelInterpolationFnc(value){return value[0];}}}]]})})}),/*#__PURE__*/_jsxs(Card.Footer,{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-history\"}),\"Updated 3 minutes ago\"]})]})]})}),/*#__PURE__*/_jsx(Col,{md:\"4\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(Card.Header,{children:[/*#__PURE__*/_jsx(Card.Title,{as:\"h4\",children:\"Categories\"}),/*#__PURE__*/_jsx(\"p\",{className:\"card-category\",children:\"Main Categories Consumed\"})]}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"ct-chart ct-perfect-fourth\",id:\"chartPreferences\",children:/*#__PURE__*/_jsx(ChartistGraph,{data:{labels:listOfCategories.map(function(categ){return categ[\"category\"];}),series:listOfCategories.map(function(categ){return categ[\"cardinality\"];})},type:\"Pie\"})}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"far fa-clock\"}),\"Latest data update\"]})]})]})})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(Card,{className:\"card-tasks\",children:[/*#__PURE__*/_jsxs(Card.Header,{children:[/*#__PURE__*/_jsx(Card.Title,{as:\"h4\",children:\"Expenses\"}),/*#__PURE__*/_jsx(\"p\",{className:\"card-category\",children:\"Your Expenses Feed \"})]}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsx(\"div\",{className:\"table-full-width\",children:/*#__PURE__*/_jsx(Table,{children:/*#__PURE__*/_jsx(\"tbody\",{children:expenses.map(function(expense,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsxs(\"td\",{children:[\"You have bought \",expense.expenseName,\" of category\",\" \",expense.expenseCategory,\", and of unit price\",\" $\",expense.expenseUnitPrice,\". The total money spent is\",\" $\",expense.expenseTotalPrice]})]},index);})})})})})]})})})]})});}export default Dashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}