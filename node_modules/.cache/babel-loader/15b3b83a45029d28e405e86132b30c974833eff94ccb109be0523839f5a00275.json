{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/TRETEC/Desktop/Software Engineering/Tp/code/Expense Tracker Website/light-bootstrap-dashboard-react/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/TRETEC/Desktop/Software Engineering/Tp/code/Expense Tracker Website/light-bootstrap-dashboard-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/TRETEC/Desktop/Software Engineering/Tp/code/Expense Tracker Website/light-bootstrap-dashboard-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState}from\"react\";// react-bootstrap components\nimport{Button,Card,Form,Container,Row,Col,Dropdown}from\"react-bootstrap\";import{AuthContext}from\"../context/AuthContext\";import{addDoc,collection,doc,updateDoc}from\"firebase/firestore\";import{db}from\"../database/firebase\";import{v4 as uuidv4}from\"uuid\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function User(){var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser,userInfo=_useContext.userInfo;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),successfullCreation=_useState2[0],setSuccessfullCreation=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),successfulUpdate=_useState4[0],setSuccessfullUpdate=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),errorUpdate=_useState8[0],setErrorUpdate=_useState8[1];// this part of updating the profile\nvar _useState9=useState(userInfo.userName),_useState10=_slicedToArray(_useState9,2),userName=_useState10[0],setUserName=_useState10[1];var _useState11=useState(userInfo.email),_useState12=_slicedToArray(_useState11,2),email=_useState12[0],setEmail=_useState12[1];var _useState13=useState(userInfo.fullName),_useState14=_slicedToArray(_useState13,2),fullName=_useState14[0],setFullName=_useState14[1];var _useState15=useState(userInfo.city),_useState16=_slicedToArray(_useState15,2),city=_useState16[0],setCity=_useState16[1];var _useState17=useState(userInfo.country),_useState18=_slicedToArray(_useState17,2),country=_useState18[0],setCountry=_useState18[1];var _useState19=useState(userInfo.income),_useState20=_slicedToArray(_useState19,2),income=_useState20[0],setIncome=_useState20[1];// this part of adding a new sub user\nvar _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),subUserIncome=_useState22[0],setSubUserIncome=_useState22[1];var _useState23=useState(\"Child\"),_useState24=_slicedToArray(_useState23,2),selectedOption=_useState24[0],setSelectedOption=_useState24[1];var _useState25=useState(\"\"),_useState26=_slicedToArray(_useState25,2),subUserCode=_useState26[0],setSubUserCode=_useState26[1];var handleUpdate=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var userRef;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();userRef=doc(db,\"users\",currentUser.uid);_context.prev=2;_context.next=5;return updateDoc(userRef,{userName:userName?userName:userInfo.fullName,fullName:fullName?fullName:userInfo.fullName,photoURL:userInfo.photoURL,email:email?email:userInfo.email,city:city?city:userInfo.city,income:income?income:userInfo.income?userInfo.income:0,country:country?country:userInfo.country,uid:currentUser.uid});case 5:setSuccessfullUpdate(true);_context.next=13;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](2);console.log(_context.t0);setSuccessfullUpdate(false);setErrorUpdate(true);case 13:setTimeout(function(){setSuccessfullUpdate(false);},4000);case 14:case\"end\":return _context.stop();}},_callee,null,[[2,8]]);}));return function handleUpdate(_x){return _ref.apply(this,arguments);};}();var handleChange=function handleChange(e){setSelectedOption(e.target.value);};var handleAddingSubUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var subUserCodeTemp,today,date,time,dateTime;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:e.preventDefault();subUserCodeTemp=uuidv4();_context2.prev=2;today=new Date();date=today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();time=today.getHours()+\":\"+today.getMinutes()+\":\"+today.getSeconds();dateTime=date+' '+time;setSubUserCode(subUserCodeTemp);_context2.next=10;return addDoc(collection(db,'users'),{user_id:currentUser.uid,is_sub_user:true,income:subUserIncome,sub_user_code:subUserCodeTemp,type:selectedOption,activated:false});case 10:_context2.next=12;return addDoc(collection(db,\"Expenses\"),{user_id:currentUser.uid,expenseName:\"Adding a Sub user\",expenseCategory:\"Sub-user\",expenseUnitPrice:subUserIncome,expenseTotalPrice:subUserIncome,created_at:dateTime});case 12:setSuccessfullCreation(true);_context2.next=20;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](2);console.log(_context2.t0);setError(true);setLoading(false);case 20:case\"end\":return _context2.stop();}},_callee2,null,[[2,15]]);}));return function handleAddingSubUser(_x2){return _ref2.apply(this,arguments);};}();console.log(userInfo);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Container,{fluid:true,children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:\"7\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Card.Header,{children:/*#__PURE__*/_jsx(Card.Title,{as:\"h4\",children:\"Edit Profile\"})}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Form,{onSubmit:function onSubmit(e){return handleUpdate(e);},children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{className:\" px-1 ml-2\",md:\"3\",children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Username\"}),/*#__PURE__*/_jsx(Form.Control,{value:userName,placeholder:userInfo.userName,onChange:function onChange(e){return setUserName(e.target.value);},type:\"text\"})]})}),/*#__PURE__*/_jsx(Col,{className:\"pl-1\",md:\"4\",children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleInputEmail1\",children:\"Email address\"}),/*#__PURE__*/_jsx(Form.Control,{placeholder:userInfo.email,value:email,onChange:function onChange(e){return setEmail(e.target.value);},type:\"email\"})]})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{className:\"pr-1\",md:\"6\",children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Full Name\"}),/*#__PURE__*/_jsx(Form.Control,{placeholder:userInfo.fullName,value:fullName,onChange:function onChange(e){return setFullName(e.target.value);},type:\"text\"})]})}),!userInfo.is_sub_user&&/*#__PURE__*/_jsx(Col,{className:\"pr-1\",md:\"6\",children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Income\"}),/*#__PURE__*/_jsx(Form.Control,{placeholder:userInfo.income,value:income,onChange:function onChange(e){return setIncome(e.target.value);},type:\"number\"})]})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{className:\"pr-1\",md:\"4\",children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"City\"}),/*#__PURE__*/_jsx(Form.Control,{placeholder:userInfo.city,value:city,onChange:function onChange(e){return setCity(e.target.value);},type:\"text\"})]})}),/*#__PURE__*/_jsx(Col,{className:\"px-1\",md:\"4\",children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Country\"}),/*#__PURE__*/_jsx(Form.Control,{placeholder:userInfo.country,value:country,onChange:function onChange(e){return setCountry(e.target.value);},type:\"text\"})]})})]}),/*#__PURE__*/_jsx(Button,{className:\"btn-fill pull-right mt-1\",type:\"submit\",variant:\"info\",children:\"Update Profile\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"clearfix\",children:[errorUpdate&&/*#__PURE__*/_jsx(\"span\",{className:\"title text-danger\",style:{fontSize:'1rem'},children:\"An Error had happened, Try Again Later...\"}),successfulUpdate&&/*#__PURE__*/_jsx(\"span\",{className:\"title text-success\",style:{fontSize:'1rem'},children:\"Updated Successfully \"})]})]})})]})}),/*#__PURE__*/_jsx(Col,{md:\"4\",children:/*#__PURE__*/_jsx(Card,{className:\"card-user\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"author mt-3\",children:[/*#__PURE__*/_jsxs(\"a\",{href:\"#pablo\",onClick:function onClick(e){return e.preventDefault();},children:[/*#__PURE__*/_jsx(\"img\",{alt:\"...\",className:\"avatar border-gray\",src:userInfo.photoURL}),/*#__PURE__*/_jsx(\"h5\",{className:\"title\",children:userInfo.fullName})]}),/*#__PURE__*/_jsx(\"p\",{className:\"description\",children:userInfo.userName})]})})})})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"10\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Card.Header,{children:/*#__PURE__*/_jsx(Card.Title,{as:\"h4\",children:\"Create a Subuser\"})}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Form,{onSubmit:function onSubmit(e){return handleUpdate(e);},children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{className:\"pr-1\",md:\"6\",children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Income\"}),/*#__PURE__*/_jsx(Form.Control,{value:subUserIncome,onChange:function onChange(e){return setSubUserIncome(e.target.value);},type:\"number\"})]})}),/*#__PURE__*/_jsx(Col,{className:\"pl-1\",md:\"6\",children:/*#__PURE__*/_jsxs(Dropdown,{className:\"d-flex form-select flex-column ml-2 my-2 h-25\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"dropdown\",children:\"Relative\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"dropdown\",className:\"form-control\",onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"Child\",children:\"Child\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Husband\",children:\"Husband\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Wife\",children:\"Wife\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Friend\",children:\"Friend\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Relative\",children:\"Relative\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Other\",children:\"Other\"})]})]})})]}),/*#__PURE__*/_jsx(Button,{className:\"btn-fill pull-right mt-1\",type:\"submit\",variant:\"info\",onClick:handleAddingSubUser,children:\"Create a new Subuser\"}),successfullCreation&&/*#__PURE__*/_jsxs(\"div\",{className:\"clearfix mt-2\",children:[\"Provide the sub-user with this code \",/*#__PURE__*/_jsx(\"span\",{className:\"text-success\",children:subUserCode})]})]})})]})})})]})});}export default User;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}